C:\Python27\python.exe "C:/Users/mayur/PycharmProjects/BCR Code/BCR.py"

Cryptography Project Challenge:	 BCR Code (Book-Caesar-RSA)

Challenge Link:

https://www.mysterytwisterc3.org/images/challenges/mtc3-theofanidis-01-bcr-en.pdf

Team:
		Mayuri Wadkar
		Pratik Surana
--------------------------------------------------------------------------------------
Introduction
Once upon a time, there have been three pirates: Alice, Bob and
Eve. They lived on the island Mallorca near a village called Porreres.
One day, while Alice and Bob were digging in their garden, they
found a treasure map. Because they could not gure out how to
use the instructions, they asked Eve who was an expert on
mysteries and riddles for help.
It turned out that Eve has made copies of the map and the
instructions for herself and is trying to nd the treasure on her own.
Can you help Alice and Bob to nd the treasure before Eve nds
the location?

The points A,B,C,D,E marked on the map are potential starting points of the treasure hunt.

Stage1-------------------------------------------------------------------------------------------

Book Text:
SIERRA-ZERO-JULIET-SIX-YANKEE-ONE-ROMEO-PAPPA-EIGHT-KILO-FIVE-UNIFORM-XRAY-XXX-BRAVO-VICTOR-TWO-FOUR-TANGO-MIKE-OSCAR-HOTEL-DELTA-QUEBECK-FOXTROT-ALPHA-YYY-LIMA-INDIA-THREE-WHISKEY-NOVEMBER-ECHO-CHARLIE-GOLF-ZULU

Decoded Text:
['S', '0', 'J', '6', 'Y', '1', 'R', 'P', '8', 'K', '5', 'U', 'X', 'XXX', 'B', 'V', '2', '4', 'T', 'M', 'O', 'H', 'D', 'Q', 'F', 'A', 'YYY', 'L', 'I', '3', 'W', 'N', 'E', 'C', 'G', 'Z']

Cryptanalysis : Numbers 7 & 9 are missing..

Two possible decoding:

1st possibility:
['S', '0', 'J', '6', 'Y', '1', 'R', 'P', '8', 'K', '5', 'U', 'X', '7', 'B', 'V', '2', '4', 'T', 'M', 'O', 'H', 'D', 'Q', 'F', 'A', '9', 'L', 'I', '3', 'W', 'N', 'E', 'C', 'G', 'Z']
2nd possibility:
['S', '0', 'J', '6', 'Y', '1', 'R', 'P', '8', 'K', '5', 'U', 'X', '9', 'B', 'V', '2', '4', 'T', 'M', 'O', 'H', 'D', 'Q', 'F', 'A', '7', 'L', 'I', '3', 'W', 'N', 'E', 'C', 'G', 'Z']

Final Number :
02192404240811270719140602241104010404040830181419040718071412122419071917091206240627010706270414300408091817060212081914040614080908171814042718180830060408090714170617271709243024090912081917091427012404113007060419062409011109180619111802270619

Final Number processed:
['02', '19', '24', '04', '24', '08', '11', '27', '07', '19', '14', '06', '02', '24', '11', '04', '01', '04', '04', '04', '08', '30', '18', '14', '19', '04', '07', '18', '07', '14', '12', '12', '24', '19', '07', '19', '17', '09', '12', '06', '24', '06', '27', '01', '07', '06', '27', '04', '14', '30', '04', '08', '09', '18', '17', '06', '02', '12', '08', '19', '14', '04', '06', '14', '08', '09', '08', '17', '18', '14', '04', '27', '18', '18', '08', '30', '06', '04', '08', '09', '07', '14', '17', '06', '17', '27', '17', '09', '24', '30', '24', '09', '09', '12', '08', '19', '17', '09', '14', '27', '01', '24', '04', '11', '30', '07', '06', '04', '19', '06', '24', '09', '01', '11', '09', '18', '06', '19', '11', '18', '02', '27', '06', '19']

Two possible final number decodings:

1st possibility:
['0', 'T', 'Q', '6', 'Q', 'P', '5', '9', 'R', 'T', '7', '1', '0', 'Q', '5', '6', 'S', '6', '6', '6', 'P', '3', '4', '7', 'T', '6', 'R', '4', 'R', '7', 'U', 'U', 'Q', 'T', 'R', 'T', '2', '8', 'U', '1', 'Q', '1', '9', 'S', 'R', '1', '9', '6', '7', '3', '6', 'P', '8', '4', '2', '1', '0', 'U', 'P', 'T', '7', '6', '1', '7', 'P', '8', 'P', '2', '4', '7', '6', '9', '4', '4', 'P', '3', '1', '6', 'P', '8', 'R', '7', '2', '1', '2', '9', '2', '8', 'Q', '3', 'Q', '8', '8', 'U', 'P', 'T', '2', '8', '7', '9', 'S', 'Q', '6', '5', '3', 'R', '1', '6', 'T', '1', 'Q', '8', 'S', '5', '8', '4', '1', 'T', '5', '4', '0', '9', '1', 'T']
2nd possibility:
['0', 'T', 'Q', '6', 'Q', 'P', '5', '7', 'R', 'T', '9', '1', '0', 'Q', '5', '6', 'S', '6', '6', '6', 'P', '3', '4', '9', 'T', '6', 'R', '4', 'R', '9', 'U', 'U', 'Q', 'T', 'R', 'T', '2', '8', 'U', '1', 'Q', '1', '7', 'S', 'R', '1', '7', '6', '9', '3', '6', 'P', '8', '4', '2', '1', '0', 'U', 'P', 'T', '9', '6', '1', '9', 'P', '8', 'P', '2', '4', '9', '6', '7', '4', '4', 'P', '3', '1', '6', 'P', '8', 'R', '9', '2', '1', '2', '7', '2', '8', 'Q', '3', 'Q', '8', '8', 'U', 'P', 'T', '2', '8', '9', '7', 'S', 'Q', '6', '5', '3', 'R', '1', '6', 'T', '1', 'Q', '8', 'S', '5', '8', '4', '1', 'T', '5', '4', '0', '7', '1', 'T']


Stage2-------------------------------------------------------------------------------------------

Shifting digits by 7 to left & shifting letters by 15 to right for 1st possibility from stage 1
['7', 'E', 'B', '3', 'B', 'A', '2', '6', 'C', 'E', '4', '8', '7', 'B', '2', '3', 'D', '3', '3', '3', 'A', '0', '1', '4', 'E', '3', 'C', '1', 'C', '4', 'F', 'F', 'B', 'E', 'C', 'E', '9', '5', 'F', '8', 'B', '8', '6', 'D', 'C', '8', '6', '3', '4', '0', '3', 'A', '5', '1', '9', '8', '7', 'F', 'A', 'E', '4', '3', '8', '4', 'A', '5', 'A', '9', '1', '4', '3', '6', '1', '1', 'A', '0', '8', '3', 'A', '5', 'C', '4', '9', '8', '9', '6', '9', '5', 'B', '0', 'B', '5', '5', 'F', 'A', 'E', '9', '5', '4', '6', 'D', 'B', '3', '2', '0', 'C', '8', '3', 'E', '8', 'B', '5', 'D', '2', '5', '1', '8', 'E', '2', '1', '7', '6', '8', 'E']

Shifting digits by 7 to right & shifting letters by 15 to right for 1st possibility from stage 1
['3', 'E', 'B', '9', 'B', 'A', '8', '2', 'C', 'E', '0', '4', '3', 'B', '8', '9', 'D', '9', '9', '9', 'A', '6', '7', '0', 'E', '9', 'C', '7', 'C', '0', 'F', 'F', 'B', 'E', 'C', 'E', '5', '1', 'F', '4', 'B', '4', '2', 'D', 'C', '4', '2', '9', '0', '6', '9', 'A', '1', '7', '5', '4', '3', 'F', 'A', 'E', '0', '9', '4', '0', 'A', '1', 'A', '5', '7', '0', '9', '2', '7', '7', 'A', '6', '4', '9', 'A', '1', 'C', '0', '5', '4', '5', '2', '5', '1', 'B', '6', 'B', '1', '1', 'F', 'A', 'E', '5', '1', '0', '2', 'D', 'B', '9', '8', '6', 'C', '4', '9', 'E', '4', 'B', '1', 'D', '8', '1', '7', '4', 'E', '8', '7', '3', '2', '4', 'E']

Shifting digits by 7 to left & shifting letters by 15 to right for 2nd possibility from stage 1
['7', 'E', 'B', '3', 'B', 'A', '2', '4', 'C', 'E', '6', '8', '7', 'B', '2', '3', 'D', '3', '3', '3', 'A', '0', '1', '6', 'E', '3', 'C', '1', 'C', '6', 'F', 'F', 'B', 'E', 'C', 'E', '9', '5', 'F', '8', 'B', '8', '4', 'D', 'C', '8', '4', '3', '6', '0', '3', 'A', '5', '1', '9', '8', '7', 'F', 'A', 'E', '6', '3', '8', '6', 'A', '5', 'A', '9', '1', '6', '3', '4', '1', '1', 'A', '0', '8', '3', 'A', '5', 'C', '6', '9', '8', '9', '4', '9', '5', 'B', '0', 'B', '5', '5', 'F', 'A', 'E', '9', '5', '6', '4', 'D', 'B', '3', '2', '0', 'C', '8', '3', 'E', '8', 'B', '5', 'D', '2', '5', '1', '8', 'E', '2', '1', '7', '4', '8', 'E']

Shifting digits by 7 to right & shifting letters by 15 to right for 2nd possibility from stage 1
['3', 'E', 'B', '9', 'B', 'A', '8', '0', 'C', 'E', '2', '4', '3', 'B', '8', '9', 'D', '9', '9', '9', 'A', '6', '7', '2', 'E', '9', 'C', '7', 'C', '2', 'F', 'F', 'B', 'E', 'C', 'E', '5', '1', 'F', '4', 'B', '4', '0', 'D', 'C', '4', '0', '9', '2', '6', '9', 'A', '1', '7', '5', '4', '3', 'F', 'A', 'E', '2', '9', '4', '2', 'A', '1', 'A', '5', '7', '2', '9', '0', '7', '7', 'A', '6', '4', '9', 'A', '1', 'C', '2', '5', '4', '5', '0', '5', '1', 'B', '6', 'B', '1', '1', 'F', 'A', 'E', '5', '1', '2', '0', 'D', 'B', '9', '8', '6', 'C', '4', '9', 'E', '4', 'B', '1', 'D', '8', '1', '7', '4', 'E', '8', '7', '3', '0', '4', 'E']


Stage3-------------------------------------------------------------------------------------------

Cryptanalysis : Converting stage2 four HEX outputs to Decimal
Output1:	101256184223409446107789021868963474404732184757844868204234331990113230891351489316397721175724472033455110515252383491798780078247596167645957813902
Output2:	50128190848621962191008658423392530960013653964008820122341404311217561165537455254144570149659309053721142936464401700360179699485409768697057718862
Output3:	101256184128164499676092694936544582683090061164787343137080160084804925098350467200438110988470764158708304041442541012545064961746492179560647455886
Output4:	50128190753377015759312331490973639238371530370951295055187232405909255372536433138184959962405601178974336462654559221106464582984305780611747360846

Cryptanalysis : 2nd decimal output contains a standard e value 65537
Splitting it to get n,e,c for RSA
n = 501281908486219621910086584233925309600136539640088201223414043112175611
e = 65537
c = 455254144570149659309053721142936464401700360179699485409768697057718862

We used an online tool to factorize n value..
https://factordb.com/index.php

after factorizing n we get,
p = 578455732137135466812346681323546443
q = 866586465716584657165746753876546577

inverting e to get d(=e^(-1) mod ((p-1)*(q-1)) )..
(p-1) = 578455732137135466812346681323546442
(q-1) = 866586465716584657165746753876546576
(p-1)*(q-1) = 501281908486219621910086584233925308155094341786368077245320607912082592
Finding d by multiplicative modular inverse..
d = 298082873119252710460625055681222869281660460407961156878212145977719009

Decrypting c.... (m=c^d mod n)
Finding m i.e. Plaintext...
m = 70082079077068071079078079082084072051055087069083084050051068073071053

Splitting into tuples of size 3
['700', '820', '790', '770', '680', '710', '790', '780', '790', '820', '840', '720', '510', '550', '870', '690', '830', '840', '500', '510', '680', '730', '710', '53']

Finding ASCII values for each tuple in m..

Message Broken:------------------------------------------------------------------->>
F R O M D G O N O R T H 3 7 W E S T 2 3 D I G 5 
---------------------------------------------------------------------------------->>


Lets go treasure hunting... :)


Stage4 : Encrypting broken message back to get original book text--------------

RSA cipher encryption..
70082079077068071079078079082084072051055087069083084050051068073071053

Ciphertext discovered:	455254144570149659309053721142936464401700360179699485409768697057718862

DecimalRSAInput:	50128190848621962191008658423392530960013653964008820122341404311217561165537455254144570149659309053721142936464401700360179699485409768697057718862

Decimal to HEX: ['3', 'E', 'B', '9', 'B', 'A', '8', '2', 'C', 'E', '0', '4', '3', 'B', '8', '9', 'D', '9', '9', '9', 'A', '6', '7', '0', 'E', '9', 'C', '7', 'C', '0', 'F', 'F', 'B', 'E', 'C', 'E', '5', '1', 'F', '4', 'B', '4', '2', 'D', 'C', '4', '2', '9', '0', '6', '9', 'A', '1', '7', '5', '4', '3', 'F', 'A', 'E', '0', '9', '4', '0', 'A', '1', 'A', '5', '7', '0', '9', '2', '7', '7', 'A', '6', '4', '9', 'A', '1', 'C', '0', '5', '4', '5', '2', '5', '1', 'B', '6', 'B', '1', '1', 'F', 'A', 'E', '5', '1', '0', '2', 'D', 'B', '9', '8', '6', 'C', '4', '9', 'E', '4', 'B', '1', 'D', '8', '1', '7', '4', 'E', '8', '7', '3', '2', '4', 'E']

Caesar cipher encryption..

Caesar cipher ciphertext:	
['0', 'T', 'Q', '6', 'Q', 'P', '5', '9', 'R', 'T', '7', '1', '0', 'Q', '5', '6', 'S', '6', '6', '6', 'P', '3', '4', '7', 'T', '6', 'R', '4', 'R', '7', 'U', 'U', 'Q', 'T', 'R', 'T', '2', '8', 'U', '1', 'Q', '1', '9', 'S', 'R', '1', '9', '6', '7', '3', '6', 'P', '8', '4', '2', '1', '0', 'U', 'P', 'T', '7', '6', '1', '7', 'P', '8', 'P', '2', '4', '7', '6', '9', '4', '4', 'P', '3', '1', '6', 'P', '8', 'R', '7', '2', '1', '2', '9', '2', '8', 'Q', '3', 'Q', '8', '8', 'U', 'P', 'T', '2', '8', '7', '9', 'S', 'Q', '6', '5', '3', 'R', '1', '6', 'T', '1', 'Q', '8', 'S', '5', '8', '4', '1', 'T', '5', '4', '0', '9', '1', 'T']

Book cipher encryption..

Book cipher ciphertext: ['S', '0', 'J', '6', 'Y', '1', 'R', 'P', '8', 'K', '5', 'U', 'X', '7', 'B', 'V', '2', '4', 'T', 'M', 'O', 'H', 'D', 'Q', 'F', 'A', '9', 'L', 'I', '3', 'W', 'N', 'E', 'C', 'G', 'Z']

From above ciphertext we get our original boot text back...
SIERRA-ZERO-JULIET-SIX-YANKEE-ONE-ROMEO-PAPPA-EIGHT-KILO-FIVE-UNIFORM-XRAY-XXX-BRAVO-VICTOR-TWO-FOUR-TANGO-MIKE-OSCAR-HOTEL-DELTA-QUEBECK-FOXTROT-ALPHA-YYY-LIMA-INDIA-THREE-WHISKEY-NOVEMBER-ECHO-CHARLIE-GOLF-ZULU

Process finished with exit code 0
